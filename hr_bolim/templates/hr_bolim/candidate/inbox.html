{% extends 'hr_bolim/candidate/base_candidate.html' %}

{% block title %}Xabarlar{% endblock %}

{% block content %}
<div class="page-header" style="margin-bottom: 2rem;">
    <h1 style="font-size: 1.8rem; font-weight: 700; color: var(--dark);">Xabarlar</h1>
</div>

<div class="card" style="padding: 0; overflow: hidden;">
    {% if conversations %}
        <div class="conversation-list">
            {% for chat in conversations %}
            <a href="{% url 'chat_detail' chat.user.id %}" class="conversation-item" style="display: flex; align-items: center; gap: 1rem; padding: 1.25rem; border-bottom: 1px solid var(--border); text-decoration: none; color: inherit; transition: background 0.2s;">
                <div style="width: 50px; height: 50px; background: #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: var(--secondary);">
                    <i class="fas fa-user"></i>
                </div>
                <div style="flex: 1;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.25rem;">
                        <h4 style="font-weight: 600; color: var(--dark);">
                            {{ chat.user.get_full_name|default:chat.user.username }}
                        </h4>
                        <span style="font-size: 0.85rem; color: var(--secondary);">
                            {{ chat.last_message.timestamp|timesince }} oldin
                        </span>
                    </div>
                    <p style="color: var(--text-secondary); font-size: 0.95rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 90%;">
                        {% if chat.last_message.sender == request.user %}
                            <i class="fas fa-reply" style="font-size: 0.8rem; margin-right: 0.25rem;"></i>
                        {% endif %}
                        {{ chat.last_message.content }}
                    </p>
                </div>
            </a>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state" style="text-align: center; padding: 4rem 2rem;">
            <i class="far fa-comments" style="font-size: 3rem; color: #cbd5e1; margin-bottom: 1.5rem;"></i>
            <h3 style="color: var(--dark);">Xabarlar yo'q</h3>
            <p style="color: var(--secondary);">Sizda hali hech qanday yozishmalar mavjud emas.</p>
        </div>
    {% endif %}
</div>

<style>
    .conversation-item:hover {
        background: #f8fafc;
    }
    .conversation-item:last-child {
        border-bottom: none;
    }
</style>
{% endblock %}
